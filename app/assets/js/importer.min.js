var currentNode=new Array,nodeOffset="",jci_element=null;jQuery(document).ready(function(a){var b,c={};a("#jc-importer_parser_settings-import_base").on("change",function(){a.fn.nodeSelect(null)}),a.fn.nodeSelect=function(d){c={action:"jc_import_file",id:ajax_object.id,base:a("#jc-importer_parser_settings-import_base").val()},void 0!==d&&(c.base=d),c.base&&(b=c.base.split("/"),nodeOffset=b[b.length-1]),a("<b>–</b>").prependTo("#treeView li:has(li)").click(function(){"–"==a(this).text()?a(this).text("+").parent("li").find(" > ul").children().hide():a(this).text("–").parent("li").find(" > ul").children().show()});var e="";a(".xml-draggable").click(function(){e=a(this).data("xpath"),jci_element.val("{"+e+"}"),jci_element.trigger("change"),tb_remove()})}}),jQuery(function(a){a("#jc-importer_parser_settings-import_base").click(function(){var b=(a(this),{action:"jc_base_node",id:ajax_object.id});a.post(ajax_object.ajax_url,b,function(b){a("#xml_preview_box").html(b)})})}),jQuery(document).ready(function(a){a(document).on("click",".xml-import .jci-import-edit",function(b){var c=a(this).closest(".jci-node-group"),d=a("#jc-importer_parser_settings-import_base").val();a(this).parent().hasClass("jci-group")&&(d+=c.find(".jc-importer_general-group input").val()),jci_element=a(this).parent().find("input");tb_show("Node Select",ajax_object.node_ajax_url+"&type=xml&current="+jci_element.val()+"&base="+d);b.preventDefault()}),a(document).on("click",".base-node-select",function(b){if(a(this).hasClass("base"))jci_element=a(this).parent().find("input"),tb_show("Node Select",ajax_object.base_node_ajax_url+"&current="+jci_element.val());else{var c=a("#jc-importer_parser_settings-import_base").val();jci_element=a(this).parent().find("input"),tb_show("Node Select",ajax_object.base_node_ajax_url+"&current="+jci_element.val()+"&base="+c)}b.preventDefault()})}),jQuery(function(a){a(document).on("click",".csv-import .jci-import-edit",function(b){jci_element=a(this).parent().find("input");tb_show("Node Select",ajax_object.node_ajax_url+"&type=csv&width=800");b.preventDefault()})}),function(a){a.fn.jci_enableField=function(b,c){var d=a('input[name="jc-importer_template_settings['+b+']"]'),e=a("#jc-importer_field-"+c);e.length||(e=a(c)),d.on("change",function(){var b=e.parent();a(this).is(":checked")?b.show():b.hide()}),d.trigger("change")},a.fn.jci_enableSelectField=function(b,c){var d=a('input[name="jc-importer_template_settings['+b+']"]'),e=a("input#jc-importer_field-"+c),f=a("select#jc-importer_field-"+c),g=f[0].outerHTML,h=e[0].outerHTML,i=e.val(),j=0;d.on("change",function(){a(this).is(":checked")?(1==j&&(i=a("select#jc-importer_field-"+c).val()),a("select#jc-importer_field-"+c).replaceWith(h),i.length>0&&a("input#jc-importer_field-"+c).val(i),a("input#jc-importer_field-"+c).parent().removeClass("select")):(1==j&&(i=a("input#jc-importer_field-"+c).val()),a("input#jc-importer_field-"+c).replaceWith(g),i.length>0&&a("select#jc-importer_field-"+c).val(i),a("select#jc-importer_field-"+c).parent().addClass("select"))}),d.trigger("change"),j=1}}(jQuery);